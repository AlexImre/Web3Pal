import { v4 as uuidv4 } from 'uuid';
import { createContext } from 'react';
import { AnyBulkWriteOperation, ObjectId } from 'mongodb';
export interface PersonalInformationType {
    name: string;
    email: string;
    addressLine1: string;
    addressLine2: string;
    city: string;
    county: string;
    postalCode: string;
    country: string;
}

export interface RecipientInformationType {
    clientName: string;
    clientEmail: string;
    clientAddressLine1: string;
    clientAddressLine2: string;
    clientCity: string;
    clientCounty: string;
    clientPostalCode: string;
    clientCountry: string;
}

export interface InvoiceInformationType {
    invoiceNumber: string;
    issueDate: string;
    dueDate: string;
}

export interface PaymentInformationType {
    invoiceLabelling: string;
    paymentMethod: string;
    popularPlatform: string;
    popularCurrency: string;
    customCurrencyName: string;
    customCurrencySymbol: string;
    customCurrencyPlatform: string;
    customCurrencyAddress: string;
    walletName: string;
    walletAddress: string;
    bankAccountName: string;
    bankAccountDetails: string;
    marketPrice: number;
}

export interface NotesInformationType {
    notes: string;
}

export type ServiceType = {
    uuid: string;
    serviceId: Number;
    description: string;
    quantity: number;
    price: number;
    discount: number;
    tax: number;
    amount: number;
}

export type FormCompletionType = {
    personalInformation: boolean;
    invoiceInformation: boolean;
    recipientInformation: boolean;
    paymentInformation: boolean;
    servicesInformation: boolean;
    notesInformation: boolean;
}

export type MasterStateType = {
    invoice: InvoiceType;
    myInvoices: any;
    myServices: any;
    myAmounts: any;
    marketData: any;
    organisation: OrganisationType;
    autoGeneratedInvoiceNumber: string;
    session: any;
}

export type InvoiceType = {
    _id?: string;
    invoiceId: string;
    organisationId: string;
    createdTimestamp: Date;
    updatedTimestamp?: Date;
    user: string;
    status?: string;
    txHash?: string;
    paidTimestamp?: Date;
    invoiceInformation: InvoiceInformationType;
    personalInformation: PersonalInformationType;
    recipientInformation: RecipientInformationType;
    paymentInformation: PaymentInformationType;
    servicesInformation: Array<ServiceType>;
    notesInformation: NotesInformationType;
    formCompletion: FormCompletionType;
}

export type OrganisationType = {
    _id?: string;
    organisationName: string;
    organisationEmail: string;
    organisationAddressLine1?: string;
    organisationAddressLine2?: string;
    organisationCity?: string;
    organisationCounty?: string;
    organisationPostalCode?: string;
    country?: string;
    createdBy: string;
    updatedBy: string;
    createdTimestamp: Date;
    updatedTimestamp: Date;
    members: Array<string>;
    admins: Array<string>;
    wallets: Array<WalletType>;
}

export type WalletType = {
    organisation_id: string;
    walletName: string;
    walletBlockchain: any;
    walletAddress: string;
    walletChainId?: string;
    createdBy: string;
    createdTimestamp: Date;
    updatedBy?: string;
    updatedTimestamp?: Date;
}

export const initialState: MasterStateType = {
    invoice: {
        _id: undefined,
        invoiceId: uuidv4(),
        organisationId: undefined,
        createdTimestamp: new Date(Date.now()),
        updatedTimestamp: undefined,
        user: '',
        status: 'Example',
        txHash: '',
        paidTimestamp: undefined,
        personalInformation: {
            name: '',  
            email: '', 
            addressLine1: '', 
            addressLine2: '', 
            city: '', 
            county: '', 
            postalCode: '', 
            country: ''
        },
        recipientInformation: {
            clientName: '',
            clientEmail: '',
            clientAddressLine1: '', 
            clientAddressLine2: '', 
            clientCity: '', 
            clientCounty: '', 
            clientPostalCode: '', 
            clientCountry: ''
        },
        invoiceInformation: {
            invoiceNumber: '', 
            issueDate: '', 
            dueDate: ''
        },
        paymentInformation: {
            invoiceLabelling: '',
            paymentMethod: 'crypto',
            popularPlatform: '',
            popularCurrency: '',
            customCurrencyName: '',
            customCurrencySymbol: '',
            customCurrencyPlatform: '',
            customCurrencyAddress: '',
            walletName: '',
            walletAddress: '',
            bankAccountName: '',
            bankAccountDetails: '',
            marketPrice:0,
        },
        servicesInformation: [{
            uuid: uuidv4(),
            serviceId: 0,
            description: 'Example Service',
            quantity: 1,
            price: 1,
            discount: 0,
            tax: 0,
            amount: 1
        }],
        notesInformation: {
            notes: ''
        },
        formCompletion: {
            personalInformation: false,
            invoiceInformation: false,
            recipientInformation: false,
            paymentInformation: false,
            servicesInformation: false,
            notesInformation: false,
        },
    },
    myInvoices: [],
    myServices: [],
    myAmounts: [],
    marketData: [],
    organisation: {
        _id: undefined,
        organisationName: '',
        organisationEmail: '',
        organisationAddressLine1: '',
        organisationAddressLine2: '',
        organisationCity: '',
        organisationCounty: '',
        organisationPostalCode: '',
        country: '',
        createdBy: '',
        updatedBy: '',
        createdTimestamp: new Date(Date.now()),
        updatedTimestamp: new Date(Date.now()),
        members: [],
        admins: [],
        wallets: []
    },
    autoGeneratedInvoiceNumber: '0',
    session: {}
}

type MasterStateContextType = {
    masterState: MasterStateType
    setMasterState: React.Dispatch<React.SetStateAction<MasterStateType>>;
}

export const defaultState: MasterStateContextType = {
    masterState: initialState,
    setMasterState: () => { }
}

export const StateContext = createContext<MasterStateContextType | null>(defaultState);